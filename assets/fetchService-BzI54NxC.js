import{a4 as f,br as L}from"./index-BdmtnMtL.js";async function i(e,a){const{data:r}=await f(e,{responseType:"json",query:{f:"json",...a==null?void 0:a.customParameters,token:a==null?void 0:a.apiKey}});return r}const p=new Set(["Catalog Layer","Feature Layer","Oriented Imagery Layer"]);async function h(e,a){const{loadContext:r,...t}=a||{},n=r?await r.fetchServiceMetadata(e,t):await i(e,t),l=L();o(n),u(n);const c={serviceJSON:n,preferredHost:l};if((n.currentVersion??0)<10.5)return c;const y=`${e}/layers`,s=r?await r.fetchServiceMetadata(y,t):await i(y,t);return o(s),u(s),c.layersJSON={layers:s.layers,tables:s.tables},c}function b(e){const{type:a}=e;return!!a&&p.has(a)}function d(e){return e.type==="Table"}function u(e){var a,r;e.layers=(a=e.layers)==null?void 0:a.filter(b),e.tables=(r=e.tables)==null?void 0:r.filter(d)}function m(e){e.type||(e.type="Feature Layer")}function w(e){e.type||(e.type="Table")}function o(e){var a,r;(a=e.layers)==null||a.forEach(m),(r=e.tables)==null||r.forEach(w)}function F(e){switch(e){case"Feature Layer":case"Table":return"FeatureLayer";case"Oriented Imagery Layer":return"OrientedImageryLayer";case"Catalog Layer":return"CatalogLayer"}return"FeatureLayer"}export{F as l,h as n,i as t};
