import{b7 as E,b8 as I,b9 as g,aZ as c,ba as b,bb as w,bc as R,a_ as T,bd as A,be as F,bf as d,bg as p,bh as D,bi as m}from"./index-BdmtnMtL.js";function Z(t,a,e=null){const n=[],s=a.mapPositions;O(a,n);const o=n[0][1].data,u=n[0][1].indices.length,r=E(u);return y(a,n,r),U(a,n,r),v(a,n,r),S(a,n,r),C(a,n,r),z(a,n,r),L(a,n,o),new I(t,n,s,g.Line,e)}function O(t,a){const{attributeData:{position:e},removeDuplicateStartEnd:n}=t,s=B(e)&&n,o=e.length/3-(s?1:0),u=new Array(2*(o-1)),r=s?e.slice(0,-3):e;let i=0;for(let f=0;f<o-1;f++)u[i++]=f,u[i++]=f+1;a.push([c.POSITION,new b(r,u,3,s)])}function y(t,a,e){if(t.attributeData.colorFeature!=null)return;const n=t.attributeData.color;a.push([c.COLOR,new b(n??w,e,4)])}function v(t,a,e){t.attributeData.normal&&a.push([c.NORMAL,new b(t.attributeData.normal,e,3)])}function S(t,a,e){t.attributeData.colorFeature!=null&&a.push([c.COLORFEATUREATTRIBUTE,new b([t.attributeData.colorFeature],e,1,!0)])}function U(t,a,e){t.attributeData.sizeFeature==null&&a.push([c.SIZE,new b([t.attributeData.size??1],e,1,!0)])}function C(t,a,e){t.attributeData.sizeFeature!=null&&a.push([c.SIZEFEATUREATTRIBUTE,new b([t.attributeData.sizeFeature],e,1,!0)])}function z(t,a,e){t.attributeData.opacityFeature!=null&&a.push([c.OPACITYFEATUREATTRIBUTE,new b([t.attributeData.opacityFeature],e,1,!0)])}function L(t,a,e){if(t.overlayInfo==null||t.overlayInfo.renderCoordsHelper.viewingMode!==R.Global||!t.overlayInfo.spatialReference.isGeographic)return;const n=T(e.length),s=A(t.overlayInfo.spatialReference);for(let l=0;l<n.length;l+=3)F(e,l,n,l,s);const o=e.length/3,u=d(o+1);let r=G,i=N,f=0,h=0;p(r,n[h++],n[h++]),h++,u[0]=0;for(let l=1;l<o+1;++l)l===o&&(h=0),p(i,n[h++],n[h++]),h++,f+=m(r,i),u[l]=f,[r,i]=[i,r];a.push([c.DISTANCETOSTART,new b(u,a[0][1].indices,1,!0)])}function B(t){const a=t.length;return t[0]===t[a-3]&&t[1]===t[a-2]&&t[2]===t[a-1]}const G=D(),N=D();function M(t,a){if(t==null||t.length===0)return[];const e=[];return t.forEach((n=>{const s=n.length,o=T(3*s);n.forEach(((r,i)=>{o[3*i]=r[0],o[3*i+1]=r[1],o[3*i+2]=r[2]}));const u={attributeData:{position:o,normal:a},removeDuplicateStartEnd:!1};e.push(u)})),e}export{M as R,Z as b};
