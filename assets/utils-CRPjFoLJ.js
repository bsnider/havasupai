const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/symbolLayerUtils-T4nmyY8X.js","assets/index-CA3J3HgS.js","assets/index-Bq0sc0Rv.css"])))=>i.map(i=>d[i]);
import{e2 as d,ab as a,lh as h,li as m,lj as k,lk as g,ll as L,_ as z}from"./index-CA3J3HgS.js";import{u as j}from"./cimSymbolUtils-BcwtBP16.js";new d(1e3);new a([128,128,128]);const _=new a("white");function M(n){if(n==null||!("symbolLayers"in n)||n.symbolLayers==null)return!1;switch(n.type){case"point-3d":return n.symbolLayers.some((o=>o.type==="object"));case"line-3d":return n.symbolLayers.some((o=>o.type==="path"));case"polygon-3d":return n.symbolLayers.some((o=>o.type==="object"||o.type==="extrude"));default:return!1}}function N(n){var o;return((o=n.resource)==null?void 0:o.href)??""}function T(n,o){if(!n)return null;let l=null;return h(n)?l=x(n):m(n)&&(l=n.type==="cim"?j(n):n.color?new a(n.color):null),l?y(l,o):null}function x(n){const o=n.symbolLayers;if(!o)return null;let l=null;return o.forEach((t=>{var r;t.type==="object"&&((r=t.resource)!=null&&r.href)||(l=t.type==="water"?t.color:t.material?t.material.color:null)})),l?new a(l):null}function y(n,o){if(o==null||n==null)return n;const l=n.toRgba();return l[3]=l[3]*o,new a(l)}function v(n,o,l){const t=n.symbolLayers;if(!t)return;const r=e=>y(o??e??(l!=null?_:null),l);t.forEach((e=>{var c,u;if(e.type!=="object"||!((c=e.resource)!=null&&c.href)||o)if(e.type==="water")e.color=r(e.color);else{const i=e.material!=null?e.material.color:null,s=r(i);if(e.material==null?e.material=new k({color:s}):e.material.color=s,l!=null&&"outline"in e&&((u=e.outline)==null?void 0:u.color)!=null&&(e.outline.color=y(e.outline.color,l)),"marker"in e&&e.marker!=null){const w=r(e.marker.color);e.marker.color=w}}}))}function S(n,o,l){var t;(o=o??n.color)&&(n.color=y(o,l)),l!=null&&"outline"in n&&((t=n.outline)!=null&&t.color)&&(n.outline.color=y(n.outline.color,l))}function U(n,o,l){n&&(o||l!=null)&&(o&&(o=new a(o)),h(n)?v(n,o,l):m(n)&&S(n,o,l))}async function E(n,o){const l=n.symbolLayers;l&&await g(l,(async t=>R(t,o)))}async function R(n,o){switch(n.type){case"extrude":O(n,o);break;case"icon":case"line":case"text":$(n,o);break;case"path":D(n,o);break;case"object":await A(n,o)}}function $(n,o){const l=p(o);l!=null&&(n.size=l)}function p(n){for(const o of n)if(typeof o=="number")return o;return null}function O(n,o){const l=o[2];typeof l=="number"&&(n.size=l)}async function A(n,o){const{resourceSize:l,symbolSize:t}=await P(n),r=b(o,l,t);r!=null&&(n.width=f(o[0],t[0],l[0],r),n.depth=f(o[1],t[1],l[1],r),n.height=f(o[2],t[2],l[2],r))}function D(n,o){const l=b(o,L,[n.width,void 0,n.height]);l!=null&&(n.width=f(o[0],n.width,1,l),n.height=f(o[2],n.height,1,l))}function b(n,o,l){for(let t=0;t<3;t++){const r=n[t];switch(r){case"symbol-value":{const e=l[t];return e!=null?e/o[t]:1}case"proportional":break;default:if(r&&o[t])return r/o[t]}}return null}async function P(n){const{computeObjectLayerResourceSize:o}=await z(()=>import("./symbolLayerUtils-T4nmyY8X.js"),__vite__mapDeps([0,1,2])),l=await o(n,10),{width:t,height:r,depth:e}=n,c=[t,e,r];let u=1;for(let i=0;i<3;i++){const s=c[i];if(s!=null){u=s/l[i];break}}for(let i=0;i<3;i++)c[i]==null&&(c[i]=l[i]*u);return{resourceSize:l,symbolSize:c}}function f(n,o,l,t){switch(n){case"proportional":return l*t;case"symbol-value":return o??l;default:return n}}function C(n,o){const l=p(o);if(l!=null)switch(n.type){case"simple-marker":n.size=l;break;case"picture-marker":{const t=n.width/n.height;t>1?(n.width=l,n.height=l*t):(n.width=l*t,n.height=l);break}case"simple-line":n.width=l;break;case"text":n.font.size=l}}async function V(n,o){if(n&&o)return h(n)?E(n,o):void(m(n)&&C(n,o))}function q(n,o,l){if(n&&o!=null)if(h(n)){const t=n.symbolLayers;t&&t.forEach((r=>{if(r.type==="object")switch(l){case"tilt":r.tilt=(r.tilt??0)+o;break;case"roll":r.roll=(r.roll??0)+o;break;default:r.heading=(r.heading??0)+o}r.type==="icon"&&(r.angle+=o)}))}else m(n)&&(n.type!=="simple-marker"&&n.type!=="picture-marker"&&n.type!=="text"||(n.angle+=o))}function B(n){return n!=null&&n.type==="polygon-3d"&&n.symbolLayers.some((o=>o.type==="extrude"))}export{B as A,U as L,V as M,q as N,N as b,M as h,T as w};
