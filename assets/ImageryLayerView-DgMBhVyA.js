import{r as a,m as n,d as v,bm as g,cJ as x,au as E,aL as p}from"./index-DXVHLZmj.js";import{i as $}from"./timeSupport-CD-PBjF9.js";import{O as D,v as F}from"./rasterProjectionHelper-DntmCLss.js";import{p as N}from"./popupUtils-iy84J5Nt.js";const T=m=>{let t=class extends m{constructor(){super(...arguments),this.view=null}get timeExtent(){var e;return $(this.layer,(e=this.view)==null?void 0:e.timeExtent,this._get("timeExtent"))}async fetchPopupFeaturesAtLocation(e,r){const{layer:i}=this;if(!e)throw new g("imagerylayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:i});const{popupEnabled:c}=i,u=N(i,r);if(!c||u==null)return[];const y=await u.getRequiredFields();x(r);const s=new E;s.timeExtent=this.timeExtent,s.geometry=e,s.outFields=y,s.outSpatialReference=e.spatialReference;const{resolution:o,spatialReference:l}=this.view,h=this.view.type==="2d"?new p(o,o,l):new p(.5*o,.5*o,l),{returnTopmostRaster:w,showNoDataRecords:d}=u.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1},f={returnDomainValues:!0,returnTopmostRaster:w,pixelSize:h,showNoDataRecords:d,signal:r==null?void 0:r.signal};return i.queryVisibleRasters(s,f).then((R=>R))}async getSourceScale(){return await F(),await this.layer.load(),D(this.layer.serviceRasterInfo,this.view.spatialReference)}canResume(){var e;return!!super.canResume()&&!((e=this.timeExtent)!=null&&e.isEmpty)}};return a([n()],t.prototype,"layer",void 0),a([n()],t.prototype,"suspended",void 0),a([n({readOnly:!0})],t.prototype,"timeExtent",null),a([n()],t.prototype,"view",void 0),t=a([v("esri.views.layers.ImageryLayerView")],t),t};export{T as m};
