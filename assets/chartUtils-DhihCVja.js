import{o as X,l as N}from"./ResponsiveTheme-BMwJJtvT.js";import{cJ as q,kz as K,kA as Q,ec as W,bB as z,iw as G,kB as T,at as _,cW as ee,kC as te,eV as O,kD as ie,kE as ne,kF as oe,kG as se,kH as ae}from"./index-DtL3GvY-.js";import{X as le,L as re}from"./chartUtilsAm5-DmMN4o5i.js";import{n as de,g as Y,b as ce,x as ue,l as fe,f as pe}from"./LineSeries-B9oEQTcx.js";import{z as x,a3 as M,r as xe,Y as me}from"./Theme-B8XVVXqF.js";import{u as E}from"./Tooltip-bYUvp7uV.js";import"./DefaultTheme-BmaG3EGP.js";import"./ColorSet-DbJMs3E1.js";import"./Tick-Qk4UBtGt.js";import"./Button-D7m73diz.js";function ge(e,n,i=10){const t=C(n-e,!1);if(t===0)return[e,n];const o=C(t/(i-1),!0);return[Math.floor(e/o)*o,Math.ceil(n/o)*o]}function C(e,n){const i=Math.floor(Math.log10(e)),t=e/10**i;let o;return o=n?t<1.5?1:t<3?2:t<5?2.5:t<7?5:10:t<=1?1:t<=2?2:t<=3?2.5:t<=5?5:10,o*10**i}const b="#f8f8f8",V="#a9a9a9",A="#323232",he="line",Ae="fill",v=15,h=12,w=.001,ve=.1,be=.02,I={fontFamily:"Avenir Next",paddingBottom:h/2,paddingLeft:0,paddingRight:0,paddingTop:0,axisGridStroke:"#f4f4f4",axisLabelsFontSize:9,axisLabelsFontWeight:"400",axisLabelsColor:V,axisTooltipFontSize:12,axisTooltipBackgroundColor:A,axisTooltipLabelColor:b,axisTooltipPaddingTop:Math.round(h/4),axisTooltipPaddingBottom:Math.round(h/4),axisTooltipPaddingHorizontal:Math.round(v/4),xAxisMinGridDistance:50,xAxisLabelsSpacing:Math.round(h/2),xAxisMinLabelPosition:.05,xAxisMaxLabelPosition:.9,yAxisMinGridDistance:30,yAxisLabelSpacing:Math.round(v/4),yAxisMinLabelPosition:0,yAxisMaxLabelPosition:.8,seriesTooltipFontSize:12,seriesTooltipBackgroundColor:b,seriesTooltipLabelColor:A,seriesFillLighten:.9,seriesTooltipSpacing:h/2,seriesTooltipPaddingVertical:Math.round(v/4),seriesTooltipPaddingHorizontal:Math.round(v/4)},ye={...I,axisGridStroke:A,axisLabelsColor:V,axisTooltipBackgroundColor:A,axisTooltipLabelColor:b,seriesTooltipBackgroundColor:A,seriesTooltipLabelColor:b,seriesFillLighten:-.75},F={minX:void 0,maxX:void 0,minY:void 0,maxY:void 0};async function Ne(e){const n=await le(e.container);q(e.abortOptions);const i=K(),t=i?ye:I;n.setThemes(i?[X.new(n),N.new(n)]:[X.new(n)]);const o=Q(e.container),s=n.container.children.push(de.new(n,{panX:!0,panY:!0,paddingTop:t.paddingTop,paddingBottom:t.paddingBottom,paddingLeft:o?t.paddingRight:t.paddingLeft,paddingRight:o?t.paddingLeft:t.paddingRight,maxTooltipDistance:-1}));s.zoomOutButton.set("forceHidden",!0);const a=s.xAxes.push(Y.new(n,{renderer:ce.new(n,{})})),l=s.yAxes.push(Y.new(n,{renderer:ue.new(n,{})})),c=z(null),d=z("loading"),r={chart:s,xAxis:a,yAxis:l,seriesInfos:new Map,messages:null,theme:t,pointerIsOver:!1,rtl:o,get state(){return d.value},get data(){return c.value},set data(p){c.value=p}};Le(r),Me(r),Te(r);const f=W([we(r,e.onRangeChange),Be(r,e.onCursorPositionChange),k(n.events.once("frameended",(()=>{d.value="ready"}))),k(n)]);return{destroy:()=>{f.remove(),d.value="destroyed"},update:p=>{p.data===r.data&&p.messages===r.messages||P(r)||Fe(r,p)},zoomOut:()=>U(r),test:void 0}}function P(e){return e.state==="destroyed"}function Te({chart:e,xAxis:n,yAxis:i}){const t=fe.new(e.root,{behavior:"none",xAxis:n,yAxis:i,snapToSeriesBy:"y"});t.lineY.set("visible",!1),e.set("cursor",t)}function Le(e){var a;const{chart:n,xAxis:i,theme:t}=e;i.setAll({extraMax:0,extraMin:0,maxDeviation:0,numberFormatter:j(e,"distance"),strictMinMax:!0,strictMinMaxSelection:!0}),i.axisHeader.set("forceHidden",!0);const o=i.get("renderer");o.setAll({inside:!1,minGridDistance:t.xAxisMinGridDistance}),o.labels.template.setAll({centerX:M,centerY:M,fill:x(t.axisLabelsColor),fontFamily:t.fontFamily,fontSize:t.axisLabelsFontSize,fontWeight:t.axisLabelsFontWeight,maxPosition:t.xAxisMaxLabelPosition,minPosition:t.xAxisMinLabelPosition,paddingLeft:0,paddingRight:0,paddingTop:t.xAxisLabelsSpacing});const s=i.set("tooltip",E.new(n.root,{paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0}));(a=s.get("background"))==null||a.setAll({fill:x(t.axisTooltipBackgroundColor),stroke:void 0}),s.label.setAll({fill:x(t.axisTooltipLabelColor),fontFamily:t.fontFamily,fontSize:t.axisTooltipFontSize,paddingBottom:t.axisTooltipPaddingBottom,paddingLeft:t.axisTooltipPaddingHorizontal,paddingRight:t.axisTooltipPaddingHorizontal,paddingTop:t.axisTooltipPaddingTop,direction:e.rtl?"rtl":"ltr"}),o.grid.template.setAll({strokeOpacity:1,stroke:x(t.axisGridStroke)})}function Me(e){const{yAxis:n,theme:i,rtl:t}=e;n.setAll({baseValue:T().noDataValue,extraMax:0,extraMin:0,maxDeviation:0,numberFormatter:j(e,"elevation"),strictMinMax:!0,strictMinMaxSelection:!0,tooltip:void 0}),n.axisHeader.set("visible",!1);const o=n.get("renderer");o.setAll({minGridDistance:i.yAxisMinGridDistance,opposite:t,inside:!0}),o.labels.template.setAll({centerX:M,centerY:xe,fill:x(i.axisLabelsColor),fontFamily:i.fontFamily,fontSize:i.axisLabelsFontSize,fontWeight:i.axisLabelsFontWeight,maxPosition:i.yAxisMaxLabelPosition,minPosition:i.yAxisMinLabelPosition,paddingBottom:0,paddingLeft:t?0:i.yAxisLabelSpacing,paddingRight:t?i.yAxisLabelSpacing:0,paddingTop:0,textAlign:"start"}),o.grid.template.setAll({strokeOpacity:1,stroke:x(i.axisGridStroke)})}function Fe(e,n){var l;if(P(e))return;const i=e.data??void 0,t=n.data??void 0;(l=e.chart.get("cursor"))==null||l.set("forceHidden",!(t!=null&&t.refined));const o=i!==t,s=(i==null?void 0:i.effectiveUnits)!==(t==null?void 0:t.effectiveUnits),a=(i==null?void 0:i.uniformScaling)!==(t==null?void 0:t.uniformScaling);e.data=t,e.messages=n.messages,(o||s)&&(Se(e),Xe(e)),a&&U(e),S(e)}function U(e){P(e)||(e.xAxis.zoom(0,1),e.yAxis.zoom(0,1))}function Se(e){const{chart:n,data:i,xAxis:t,yAxis:o}=e,{minX:s,maxX:a,minY:l,maxY:c}=ke({data:i,pixelWidth:t.width(),pixelHeight:o.height()}),d=!!(i!=null&&i.uniformScaling),r=!!(i!=null&&i.refined);n.setAll({panX:!0,panY:d,pinchZoomX:r,pinchZoomY:r&&d,wheelX:"panX",wheelY:r?d?"zoomXY":"zoomX":"none"}),t.setAll({max:a,min:s,panX:!0,panY:!1,zoomX:!0,zoomY:d}),o.setAll({max:c,min:l,panX:!1,panY:d,zoomX:d,zoomY:d})}function ke({data:e,pixelWidth:n,pixelHeight:i}){if(e==null)return F;const t=e.statistics,o=0,s=t==null?void 0:t.maxDistance;let a=t==null?void 0:t.minElevation,l=t==null?void 0:t.maxElevation;if(s==null||a==null||l==null)return F;const c=Math.max(s-o,w);let d=Math.max(l-a,w);const r=e.effectiveUnits;if(e.dynamicElevationRange){const f=G(c,r.distance,r.elevation);d=Math.max(d,f/T().maxChartRatio)}return a-=be*d,l=a+d+ve*d,[a,l]=ge(a,l,10),d=l-a,e.uniformScaling?Pe({data:e,bounds:{minX:o,maxX:s,minY:a,maxY:l},pixelWidth:n,pixelHeight:i,centered:!0}):{minX:o,maxX:o+c,minY:a,maxY:a+d}}function Pe({data:e,bounds:n,pixelWidth:i,pixelHeight:t,centered:o}){if(e==null)return n;let{minX:s,maxX:a,minY:l,maxY:c}=n;if(s==null||a==null||l==null||c==null)return F;const d=a-s,r=c-l,f=e.effectiveUnits,u=G(r,f.elevation,f.distance)/t/(d/i);return u>=1?[s,a]=B([s,a],u):[l,c]=B([l,c],1/u),{minX:s,maxX:a,minY:l,maxY:c}}function B([e,n],i,t){const o=(n-e)*i;{const s=(e+n)/2-o/2;return[s,s+o]}}function Xe(e){var d;const{chart:n,data:i,seriesInfos:t,xAxis:o,yAxis:s}=e;if(i==null||i.lines.length===0)return void n.series.clear();const a=new Map,l=new Set(n.series.values),c=i.lines.length;for(let r=0;r<c;r++){const f=i.lines[r];let u=t.get(f.id);u?(u.fill&&l.delete(u.fill),l.delete(u.line)):(u=Ye(e,f),u.fill&&n.series.push(u.fill),n.series.push(u.line)),a.set(u.id,u);const p=c-r-1;(d=u.fill)==null||d.set("layer",p),u.line.set("layer",c+p),ze(e,u,f)}e.seriesInfos=a;for(const r of l)n.series.removeValue(r);o.set("layer",c+1),s.set("layer",c+2)}function ze({theme:e},n,i){const t=x(i.color.toCss()),o=i.samples??[],s=o.length>0,{line:a,fill:l}=n;a.set("visible",s),a.set("stroke",t),l==null||l.set("visible",s),l==null||l.set("fill",me.lighten(t,e.seriesFillLighten)),a.data.setAll(o),l==null||l.data.setAll(o)}function Ye(e,n){const{id:i}=n,t=$(e,`${he}-${i}`),o=Ce(e);t.setAll({dy:n.chartStrokeOffsetY,tooltip:o}),t.strokes.template.setAll({strokeWidth:n.chartStrokeWidth});let s=null;return n.chartFillEnabled&&(s=$(e,`${Ae}-${i}`),s.fills.template.setAll({fillOpacity:1,visible:!0})),{id:i,line:t,fill:s}}function $(e,n){return pe.new(e.chart.root,{connect:!1,excludeFromTotal:!0,fill:void 0,id:n,stroke:void 0,valueXField:"distance",valueYField:"elevation",xAxis:e.xAxis,yAxis:e.yAxis})}function Ce({theme:e,chart:n,rtl:i}){var a;const t=E.new(n.root,{autoTextColor:!1,forceHidden:!0,getFillFromSprite:!1,getLabelFillFromSprite:!1,pointerOrientation:"vertical",visible:!1}),o=e.seriesTooltipPaddingHorizontal,s=e.seriesTooltipPaddingVertical;return t.label.setAll({fill:x(e.seriesTooltipLabelColor),fontFamily:e.fontFamily,fontSize:e.seriesTooltipFontSize,paddingBottom:s,paddingLeft:o,paddingRight:o,paddingTop:s,textAlign:i?"end":"start",direction:"ltr"}),(a=t.get("background"))==null||a.setAll({stroke:void 0,fill:x(e.seriesTooltipBackgroundColor)}),t.adapters.add("dy",(l=>{var r;const c=e.seriesTooltipSpacing,d=((r=t.get("pointTo"))==null?void 0:r.y)??0;return(l??0)+(t.y()>d?c:-c)})),t}function we(e,n){const{xAxis:i,yAxis:t}=e,o=()=>{n(y(i),y(t))},s=a=>[a.on("start",o),a.on("end",o)];return J([...s(i),...s(t)])}function y(e){const n=Math.abs((e.get("end")??0)-(e.get("start")??0)),i=n!==0?1/n:1;return Math.abs(1-i)<ie()?1:i}function Be(e,n){const{chart:i,xAxis:t,yAxis:o}=e,s=i.get("cursor"),a=i.plotContainer.events,l=d=>{e.pointerIsOver=d,S(e)},c=()=>{l(!1),n(null,null)};return J([s==null?void 0:s.events.on("cursormoved",(()=>{if(!e.pointerIsOver)return;S(e);let d=(s==null?void 0:s.getPrivate("positionX"))??0,r=(s==null?void 0:s.getPrivate("positionY"))??0;const f=e.data;if((f==null?void 0:f.statistics)!=null){const{maxDistance:u,minElevation:p,maxElevation:L}=f.statistics;let m,g;u!=null&&(y(t)===1?(m=0,g=u):(m=D(t),g=R(t)),d=H(d,m,g,0,u)),p!=null&&L!=null&&(y(o)===1?(m=p,g=L):(m=D(o),g=R(o)),r=H(r,m,g,p,L))}n(d,r)})),a.on("pointerover",(()=>l(!0))),a.on("pointerout",c),a.on("blur",c)])}function H(e,n,i,t,o){return(n+e*(i-n)-t)/(o-t)}function S(e){const n=$e(e);if(!n)return void e.seriesInfos.forEach((i=>{var t;(t=i.line.get("tooltip"))==null||t.set("forceHidden",!0)}));e.seriesInfos.forEach((i=>{const t=i.line.get("tooltip");t.set("forceHidden",!1),t.label.set("text",n)})),e.xAxis.getTooltip().setAll({tooltipText:Re(e)})}function $e(e){const{data:n}=e,i=n==null?void 0:n.lines.map((t=>{var o;return{line:t,y:(o=Z(e,t))==null?void 0:o.elevation}})).sort(He);return i&&i.length!==0&&i[0].y!=null?i.map((({y:t,line:o})=>De(e,o,t))).join(`
`):null}function He({y:e},{y:n}){return e==null?1:n==null?-1:n-e}function De(e,n,i){const{data:t,messages:o}=e;if(t==null||o==null)return"";const s=`[${n.color.toHex()}]●[/]`,a="  ",l=T().formatPrecision,c=oe(o.chartTooltip,{name:ae(n,o),elevation:i!=null?O(o,i,t.effectiveUnits.elevation,l):se});return e.rtl?c+a+s:s+a+c}function Re(e){const{data:n,messages:i}=e;if(n==null||i==null)return"";const t=n.lines[0],o=t?Z(e,t):null,s=T().formatPrecision;return o!=null?O(i,o.distance,n.effectiveUnits.distance,s):"-"}function j(e,n){const i=re.new(e.chart.root,{});return i.format=(t,o,s)=>{const{data:a,messages:l}=e;return l==null||a==null||typeof t=="string"?"":`${ee(t,{maximumFractionDigits:s})} ${te(l,a.effectiveUnits[n],"abbr")}`},i}function Z({chart:e,xAxis:n},i){const t=i.samples??[];if(t.length===0)return null;const o=e.get("cursor"),s=(o==null?void 0:o.getPrivate("positionX"))??0,a=n.toAxisPosition(s),l=n.positionToValue(a);return ne(t,l,(c=>c.distance))}function D(e){return e.positionToValue(e.get("start")??0)}function R(e){return e.positionToValue(e.get("end")??1)}function J(e){return W(e.map(k))}function k(e){return _((()=>{e==null||e.dispose()}))}export{Ne as createChart,ke as getAdjustedBounds};
