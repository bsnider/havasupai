import{d6 as x}from"./index-DXVHLZmj.js";function V(e){return(e==null?void 0:e.datasetFormat)==="Function"}function S(e){return V(e)?e.primaryRasters.rasters:[e]}const b="Raster.",u="Raster.Dim.",$=".Max",m={servicePixelValue:"Raster.ServicePixelValue",rawServicePixelValue:"Raster.ServicePixelValue.Raw",itemPixelValue:"Raster.ItemPixelValue",magnitude:"Raster.Magnitude",direction:"Raster.Direction",variable:"Raster.Variable"},w=new Map([["quarters","Quarter"],["months","Month"],["weeks","Week of the year"],["days","Day of the year"]]);function f(e,a){return new x({name:e,alias:a,domain:null,editable:!1,length:50,type:"string"})}function d(e,a){return new x({name:e,alias:a,domain:null,editable:!1,type:"double"})}function y(e,a){return new x({name:e,alias:a,domain:null,editable:!1,type:"date"})}function R(e){return f(m.servicePixelValue,e??"Service Pixel Value")}function M(e){return f(m.rawServicePixelValue,e??"Raw Service Pixel Value")}function I(){return f(m.itemPixelValue,"Item Pixel Value")}function D(e){return f(`${m.servicePixelValue}.${e}`,e)}function E(e){return d(`${m.magnitude}`,"Magnitude"+(e?` (${e})`:""))}function N(){return d(`${m.direction}`,"Direction (Â°)")}function W(e){return e.fields.filter((a=>a.type!=="oid"&&a.name.toLowerCase()!=="value")).map((a=>{const t=a.clone();return t.name=`${b}${a.name}`,t}))}function T(e){const a=new Set,t=new Set,n=new Map;return e.variables.forEach((({dimensions:i})=>{i.forEach((r=>{var o;if(r.recurring)n.set(r.name,r.unit);else{const c=((o=r.unit)==null?void 0:o.trim())==="ISO8601"?a:t;c.add(r.name),r.hasRanges&&c.add(`${r.name}${$}`)}}))})),[f(m.variable,"Variable"),...[...a].map((i=>y(`${u}${i}`,h(i)))),...[...t].map((i=>d(`${u}${i}`,h(i)))),...[...n].map((([i,r])=>d(`${u}${i}`,g(i,r))))]}function g(e,a){return a=a==null?void 0:a.toLowerCase(),a&&w.has(a)?w.get(a):h(e)}function h(e){const a=e.endsWith($),t=a?e.slice(0,-4):e,n=t==="StdTime"?"Standard Time":t==="StdZ"?"Standard Z":t;return a?`${n} Max`:n}function p(e,a){return a?new Date(e):e}function k(e,a,t){t!=null&&t.length&&(a[m.variable]=t[0].variableName,t.forEach((({dimensionName:n,values:i})=>{if(n&&(i!=null&&i.length)){const r=`${u}${n}`,o=e.find((({name:s})=>s===r));if(!o)return;const c=o.type==="date",l=i[0];if(Array.isArray(l)){if(a[`${u}${n}`]=p(l[0],c),l[1]!=null){const s=`${u}${n}${$}`;if(e.some((({name:v})=>v===s))){const v=p(l[1],c);a[s]=v}}}else a[`${u}${n}`]=p(l,c)}})))}function A(e,a){if(a.pixelType.startsWith("f")&&e.forEach((({format:t,fieldName:n})=>{t&&n&&/^raster\.(item|service)pixelvalue/i.test(n)&&(t.places=2)})),a.multidimensionalInfo){const t=a.multidimensionalInfo.variables.flatMap((({dimensions:n})=>n));e.forEach((({format:n,fieldName:i})=>{var r;if(n&&(i!=null&&i.startsWith(u))){const o=i.slice(u.length),c=`${o}${$}`,l=t.find((({name:s})=>s===o||s===c));(r=l==null?void 0:l.values)!=null&&r.every((s=>Number.isInteger(s)))&&(n.places=0)}}))}}export{N as $,k as V,S as a,A as b,M as c,E as d,u as e,D as f,I as m,b as n,R as o,T as p,V as r,m as t,W as v};
